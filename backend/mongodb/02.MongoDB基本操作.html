<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>2. MongoDB基础操作 | 雪山之巅</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="apple-touch-icon" href="/jerry.github.io/apple-touch-icon.png">
    <link rel="icon" href="/jerry.github.io/favicon.ico">
    <link rel="manifest" href="/jerry.github.io/manifest.json">
    <meta name="description" content="我与夏风皆过客1">
    <meta name="theme-color" content="#ffffff">
    
    <link rel="preload" href="/jerry.github.io/assets/css/0.styles.ba9d0c50.css" as="style"><link rel="preload" href="/jerry.github.io/assets/js/app.8cb867ca.js" as="script"><link rel="preload" href="/jerry.github.io/assets/js/2.7d547363.js" as="script"><link rel="preload" href="/jerry.github.io/assets/js/46.f81f1bfa.js" as="script"><link rel="preload" href="/jerry.github.io/assets/js/20.cf42ebc2.js" as="script"><link rel="prefetch" href="/jerry.github.io/assets/js/10.a1c8416b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/100.504935d6.js"><link rel="prefetch" href="/jerry.github.io/assets/js/101.21e817bf.js"><link rel="prefetch" href="/jerry.github.io/assets/js/102.65169271.js"><link rel="prefetch" href="/jerry.github.io/assets/js/103.6fcbe2c9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/104.11583416.js"><link rel="prefetch" href="/jerry.github.io/assets/js/105.151c8c59.js"><link rel="prefetch" href="/jerry.github.io/assets/js/106.5363313f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/107.b871dbb1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/108.3c9edfb6.js"><link rel="prefetch" href="/jerry.github.io/assets/js/109.a2864e45.js"><link rel="prefetch" href="/jerry.github.io/assets/js/11.230bdafc.js"><link rel="prefetch" href="/jerry.github.io/assets/js/110.a19fcc30.js"><link rel="prefetch" href="/jerry.github.io/assets/js/111.093fdfd1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/112.10ea3de4.js"><link rel="prefetch" href="/jerry.github.io/assets/js/113.95e556d2.js"><link rel="prefetch" href="/jerry.github.io/assets/js/114.bab0361c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/115.a9cf132f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/116.da97d300.js"><link rel="prefetch" href="/jerry.github.io/assets/js/117.36250871.js"><link rel="prefetch" href="/jerry.github.io/assets/js/118.e52f5780.js"><link rel="prefetch" href="/jerry.github.io/assets/js/119.7758e874.js"><link rel="prefetch" href="/jerry.github.io/assets/js/12.8cade74a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/120.8f88acbb.js"><link rel="prefetch" href="/jerry.github.io/assets/js/121.6dcee880.js"><link rel="prefetch" href="/jerry.github.io/assets/js/122.8777c1e2.js"><link rel="prefetch" href="/jerry.github.io/assets/js/123.16bc758e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/124.f8f1ed86.js"><link rel="prefetch" href="/jerry.github.io/assets/js/125.b4d23aeb.js"><link rel="prefetch" href="/jerry.github.io/assets/js/126.29d9ca54.js"><link rel="prefetch" href="/jerry.github.io/assets/js/127.cfe3a252.js"><link rel="prefetch" href="/jerry.github.io/assets/js/128.e7ab0c95.js"><link rel="prefetch" href="/jerry.github.io/assets/js/129.d0cac2ec.js"><link rel="prefetch" href="/jerry.github.io/assets/js/13.f32bffef.js"><link rel="prefetch" href="/jerry.github.io/assets/js/130.53ae1e24.js"><link rel="prefetch" href="/jerry.github.io/assets/js/131.b382f1b0.js"><link rel="prefetch" href="/jerry.github.io/assets/js/132.9f7a7079.js"><link rel="prefetch" href="/jerry.github.io/assets/js/133.9bedf5c8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/134.0fde1402.js"><link rel="prefetch" href="/jerry.github.io/assets/js/135.8ce45018.js"><link rel="prefetch" href="/jerry.github.io/assets/js/136.165553e5.js"><link rel="prefetch" href="/jerry.github.io/assets/js/137.6e606b3c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/138.21058c26.js"><link rel="prefetch" href="/jerry.github.io/assets/js/139.695a93ac.js"><link rel="prefetch" href="/jerry.github.io/assets/js/14.3eb5eb18.js"><link rel="prefetch" href="/jerry.github.io/assets/js/140.a9f8a3df.js"><link rel="prefetch" href="/jerry.github.io/assets/js/141.c7f4ec43.js"><link rel="prefetch" href="/jerry.github.io/assets/js/142.e5649d1a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/143.1ee6e8a2.js"><link rel="prefetch" href="/jerry.github.io/assets/js/144.94acf2f4.js"><link rel="prefetch" href="/jerry.github.io/assets/js/145.eb5135d7.js"><link rel="prefetch" href="/jerry.github.io/assets/js/146.18f8a40e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/147.b21fb0df.js"><link rel="prefetch" href="/jerry.github.io/assets/js/148.adfd1662.js"><link rel="prefetch" href="/jerry.github.io/assets/js/149.dc7e9bb0.js"><link rel="prefetch" href="/jerry.github.io/assets/js/15.5fbe3ada.js"><link rel="prefetch" href="/jerry.github.io/assets/js/150.f8fa379b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/151.6f065a1f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/152.1475f8d1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/153.78885179.js"><link rel="prefetch" href="/jerry.github.io/assets/js/154.4047c70a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/155.406967ab.js"><link rel="prefetch" href="/jerry.github.io/assets/js/156.751598e1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/157.e7a7a219.js"><link rel="prefetch" href="/jerry.github.io/assets/js/158.d1ca1de8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/159.93693f00.js"><link rel="prefetch" href="/jerry.github.io/assets/js/16.13e04a1e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/160.4657154d.js"><link rel="prefetch" href="/jerry.github.io/assets/js/161.27b64c01.js"><link rel="prefetch" href="/jerry.github.io/assets/js/162.d58c457f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/163.79343a4c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/164.5a25522e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/165.c52e5816.js"><link rel="prefetch" href="/jerry.github.io/assets/js/166.d5d598c8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/167.82b2360f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/168.88cc8b96.js"><link rel="prefetch" href="/jerry.github.io/assets/js/169.1cb9b389.js"><link rel="prefetch" href="/jerry.github.io/assets/js/17.283191f2.js"><link rel="prefetch" href="/jerry.github.io/assets/js/170.e3dcbc16.js"><link rel="prefetch" href="/jerry.github.io/assets/js/171.07ef11f3.js"><link rel="prefetch" href="/jerry.github.io/assets/js/172.c183eb41.js"><link rel="prefetch" href="/jerry.github.io/assets/js/173.59fc33e7.js"><link rel="prefetch" href="/jerry.github.io/assets/js/174.d37ec705.js"><link rel="prefetch" href="/jerry.github.io/assets/js/175.ab467af4.js"><link rel="prefetch" href="/jerry.github.io/assets/js/176.6d5f2e13.js"><link rel="prefetch" href="/jerry.github.io/assets/js/177.fd722926.js"><link rel="prefetch" href="/jerry.github.io/assets/js/178.901e44b1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/179.95aecdf1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/18.f812f6af.js"><link rel="prefetch" href="/jerry.github.io/assets/js/180.6f7205ee.js"><link rel="prefetch" href="/jerry.github.io/assets/js/181.7e1e1402.js"><link rel="prefetch" href="/jerry.github.io/assets/js/182.eb3c32f9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/183.794272e9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/184.3ed1d5af.js"><link rel="prefetch" href="/jerry.github.io/assets/js/185.2430ff76.js"><link rel="prefetch" href="/jerry.github.io/assets/js/186.46272a01.js"><link rel="prefetch" href="/jerry.github.io/assets/js/187.c617b164.js"><link rel="prefetch" href="/jerry.github.io/assets/js/19.f9e85296.js"><link rel="prefetch" href="/jerry.github.io/assets/js/21.724fc087.js"><link rel="prefetch" href="/jerry.github.io/assets/js/22.c6929093.js"><link rel="prefetch" href="/jerry.github.io/assets/js/23.f56ff06f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/24.44ba2312.js"><link rel="prefetch" href="/jerry.github.io/assets/js/25.f35c5403.js"><link rel="prefetch" href="/jerry.github.io/assets/js/26.b731cd9b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/27.3d5daa0a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/28.8cc8bab9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/29.7730d077.js"><link rel="prefetch" href="/jerry.github.io/assets/js/3.5ab0026b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/30.6d37c03b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/31.e8f4a77a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/32.549d6f8e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/33.95792b9f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/34.b7e709b1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/35.daed2e5c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/36.90c3c71a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/37.dfa11bd8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/38.e36c7a27.js"><link rel="prefetch" href="/jerry.github.io/assets/js/39.017d9b19.js"><link rel="prefetch" href="/jerry.github.io/assets/js/4.7259a42f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/40.e43eaee9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/41.697e21b6.js"><link rel="prefetch" href="/jerry.github.io/assets/js/42.f01531a7.js"><link rel="prefetch" href="/jerry.github.io/assets/js/43.84df7d63.js"><link rel="prefetch" href="/jerry.github.io/assets/js/44.891e9a3f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/45.f19e5ca4.js"><link rel="prefetch" href="/jerry.github.io/assets/js/47.8f4693a3.js"><link rel="prefetch" href="/jerry.github.io/assets/js/48.b0c93d91.js"><link rel="prefetch" href="/jerry.github.io/assets/js/49.f9f0f3f8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/5.e04d3d1e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/50.e03d13cd.js"><link rel="prefetch" href="/jerry.github.io/assets/js/51.f8825ce8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/52.ec76efc3.js"><link rel="prefetch" href="/jerry.github.io/assets/js/53.c9a34637.js"><link rel="prefetch" href="/jerry.github.io/assets/js/54.8abbd387.js"><link rel="prefetch" href="/jerry.github.io/assets/js/55.c468aca8.js"><link rel="prefetch" href="/jerry.github.io/assets/js/56.f4b50a04.js"><link rel="prefetch" href="/jerry.github.io/assets/js/57.de666ddb.js"><link rel="prefetch" href="/jerry.github.io/assets/js/58.458d0401.js"><link rel="prefetch" href="/jerry.github.io/assets/js/59.40e6b3d1.js"><link rel="prefetch" href="/jerry.github.io/assets/js/6.c98e06b3.js"><link rel="prefetch" href="/jerry.github.io/assets/js/60.43848b9a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/61.2fe1e137.js"><link rel="prefetch" href="/jerry.github.io/assets/js/62.3f176587.js"><link rel="prefetch" href="/jerry.github.io/assets/js/63.f552851c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/64.d50a2fff.js"><link rel="prefetch" href="/jerry.github.io/assets/js/65.0d627c3b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/66.78e14677.js"><link rel="prefetch" href="/jerry.github.io/assets/js/67.caf5006d.js"><link rel="prefetch" href="/jerry.github.io/assets/js/68.39e8b4be.js"><link rel="prefetch" href="/jerry.github.io/assets/js/69.bd962060.js"><link rel="prefetch" href="/jerry.github.io/assets/js/7.5838a81a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/70.578ae89e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/71.8c97f45c.js"><link rel="prefetch" href="/jerry.github.io/assets/js/72.d9e369a7.js"><link rel="prefetch" href="/jerry.github.io/assets/js/73.4b42860a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/74.1a99cf28.js"><link rel="prefetch" href="/jerry.github.io/assets/js/75.58b36cd5.js"><link rel="prefetch" href="/jerry.github.io/assets/js/76.ed9de37a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/77.227912ee.js"><link rel="prefetch" href="/jerry.github.io/assets/js/78.93f12412.js"><link rel="prefetch" href="/jerry.github.io/assets/js/79.81a03b40.js"><link rel="prefetch" href="/jerry.github.io/assets/js/8.4e52af96.js"><link rel="prefetch" href="/jerry.github.io/assets/js/80.b777d54f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/81.0b43f0cc.js"><link rel="prefetch" href="/jerry.github.io/assets/js/82.28396efa.js"><link rel="prefetch" href="/jerry.github.io/assets/js/83.1277f065.js"><link rel="prefetch" href="/jerry.github.io/assets/js/84.8e6d03c2.js"><link rel="prefetch" href="/jerry.github.io/assets/js/85.2376dca3.js"><link rel="prefetch" href="/jerry.github.io/assets/js/86.555d125a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/87.d6aee5d0.js"><link rel="prefetch" href="/jerry.github.io/assets/js/88.1737751f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/89.e3d5e734.js"><link rel="prefetch" href="/jerry.github.io/assets/js/9.6a9d759a.js"><link rel="prefetch" href="/jerry.github.io/assets/js/90.f1b5cd88.js"><link rel="prefetch" href="/jerry.github.io/assets/js/91.87444e61.js"><link rel="prefetch" href="/jerry.github.io/assets/js/92.45ed101b.js"><link rel="prefetch" href="/jerry.github.io/assets/js/93.18f7d79e.js"><link rel="prefetch" href="/jerry.github.io/assets/js/94.efb5658f.js"><link rel="prefetch" href="/jerry.github.io/assets/js/95.1228ac2d.js"><link rel="prefetch" href="/jerry.github.io/assets/js/96.c1a66ad9.js"><link rel="prefetch" href="/jerry.github.io/assets/js/97.32033135.js"><link rel="prefetch" href="/jerry.github.io/assets/js/98.37b12cfd.js"><link rel="prefetch" href="/jerry.github.io/assets/js/99.cd7ac96d.js">
    <link rel="stylesheet" href="/jerry.github.io/assets/css/0.styles.ba9d0c50.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/jerry.github.io/" class="home-link router-link-active"><!----> <span class="site-name">雪山之巅</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/jerry.github.io/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识" class="dropdown-title"><span class="title">前端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端知识" class="mobile-dropdown-title"><span class="title">前端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/es6/" class="nav-link">
  ECMAScript6
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/typescript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/javascript/" class="nav-link">
  JS基础专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/jsTopic/" class="nav-link">
  JS技术专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/jsOpt/" class="nav-link">
  JS优化专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/webpack4/" class="nav-link">
  Webpack4配置实战
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/web/" class="nav-link">
  浏览器相关
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/html/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/css/" class="nav-link">
  CSS3
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/excellent/" class="nav-link">
  优秀博客
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架知识" class="dropdown-title"><span class="title">框架知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架知识" class="mobile-dropdown-title"><span class="title">框架知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/vue/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/ReactNative/" class="nav-link">
  React Native
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/weixin/" class="nav-link">
  微信小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端知识" class="dropdown-title"><span class="title">服务端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端知识" class="mobile-dropdown-title"><span class="title">服务端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/nodejs/" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/koa/" class="nav-link">
  Koa
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/" class="nav-link router-link-active">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/http/" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/docker/" class="nav-link">
  官网知识推荐
</a></li></ul></div></div><div class="nav-item"><a href="/jerry.github.io/blog/" class="nav-link">
  其他杂谈
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/jerry.github.io/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端知识" class="dropdown-title"><span class="title">前端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端知识" class="mobile-dropdown-title"><span class="title">前端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/es6/" class="nav-link">
  ECMAScript6
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/typescript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/javascript/" class="nav-link">
  JS基础专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/jsTopic/" class="nav-link">
  JS技术专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/jsOpt/" class="nav-link">
  JS优化专题
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/webpack4/" class="nav-link">
  Webpack4配置实战
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/.html" class="nav-link">
  ---------------
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/web/" class="nav-link">
  浏览器相关
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/html/" class="nav-link">
  HTML5
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/css/" class="nav-link">
  CSS3
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frontend/excellent/" class="nav-link">
  优秀博客
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架知识" class="dropdown-title"><span class="title">框架知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="框架知识" class="mobile-dropdown-title"><span class="title">框架知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/vue/" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/ReactNative/" class="nav-link">
  React Native
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/frameModule/weixin/" class="nav-link">
  微信小程序
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="服务端知识" class="dropdown-title"><span class="title">服务端知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="服务端知识" class="mobile-dropdown-title"><span class="title">服务端知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/nodejs/" class="nav-link">
  NodeJS
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/koa/" class="nav-link">
  Koa
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mysql/" class="nav-link">
  Mysql
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/mongodb/" class="nav-link router-link-active">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/http/" class="nav-link">
  HTTP协议
</a></li><li class="dropdown-item"><!----> <a href="/jerry.github.io/backend/docker/" class="nav-link">
  官网知识推荐
</a></li></ul></div></div><div class="nav-item"><a href="/jerry.github.io/blog/" class="nav-link">
  其他杂谈
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>MongoDB</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/jerry.github.io/backend/mongodb/" aria-current="page" class="sidebar-link">mongodb</a></li><li><a href="/jerry.github.io/backend/mongodb/01.Mac安装MongoDB.html" class="sidebar-link">1. Mac安装MongoDB</a></li><li><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html" class="active sidebar-link">2. MongoDB基础操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#mongo命令行" class="sidebar-link">mongo命令行</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#基本shell命令" class="sidebar-link">基本Shell命令</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#mongodb存储结构" class="sidebar-link">MongoDB存储结构</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#数据基本操作" class="sidebar-link">数据基本操作</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#插入数据" class="sidebar-link">插入数据</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#查询数据" class="sidebar-link">查询数据</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#更新数据" class="sidebar-link">更新数据</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#删除数据" class="sidebar-link">删除数据</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#使用js文件写mongo命令" class="sidebar-link">使用js文件写mongo命令</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#批量插入数据" class="sidebar-link">批量插入数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#循环插入" class="sidebar-link">循环插入</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#批量插入" class="sidebar-link">批量插入</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#update常见错误" class="sidebar-link">update常见错误</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#update修改器" class="sidebar-link">update修改器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#set修改器" class="sidebar-link">$set修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#修改嵌套内容" class="sidebar-link">修改嵌套内容</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#unset修改器" class="sidebar-link">$unset修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#inc修改器" class="sidebar-link">$inc修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#multi选项" class="sidebar-link">multi选项</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#upsert选项" class="sidebar-link">upsert选项</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#update数组修改器" class="sidebar-link">update数组修改器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#push修改器" class="sidebar-link">$push修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#ne修改器" class="sidebar-link">$ne修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#addtoset修改器" class="sidebar-link">$addToSet修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#each修改器" class="sidebar-link">$each修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#pop修改器" class="sidebar-link">$pop修改器</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#数组定位修改" class="sidebar-link">数组定位修改</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#修改状态返回与安全" class="sidebar-link">修改状态返回与安全</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#应答式写入" class="sidebar-link">应答式写入</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#db-runcommand" class="sidebar-link">db.runCommand()</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#findandmodify" class="sidebar-link">findAndModify</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#查询find的不等修饰符" class="sidebar-link">查询find的不等修饰符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#简单查找" class="sidebar-link">简单查找</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#筛选字段" class="sidebar-link">筛选字段</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#不等修饰符" class="sidebar-link">不等修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#日期筛选" class="sidebar-link">日期筛选</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#find的多条件查询" class="sidebar-link">find的多条件查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#in修饰符" class="sidebar-link">$in修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#or修饰符" class="sidebar-link">$or修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#and修饰符" class="sidebar-link">$and修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#not修饰符" class="sidebar-link">$not修饰符</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#find的数组查询" class="sidebar-link">find的数组查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#基本数据查询" class="sidebar-link">基本数据查询</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#all修饰符" class="sidebar-link">$all修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#in修饰符-2" class="sidebar-link">$in修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#size修饰符" class="sidebar-link">$size修饰符</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#slice修饰符" class="sidebar-link">$slice修饰符</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#find的参数使用方法" class="sidebar-link">find的参数使用方法</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#模拟分页" class="sidebar-link">模拟分页</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#where修饰符" class="sidebar-link">$where修饰符</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#find如何在js文本中使用" class="sidebar-link">find如何在js文本中使用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#hasnext循环结果" class="sidebar-link">hasNext循环结果</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#foreach循环结果" class="sidebar-link">forEach循环结果</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#索引" class="sidebar-link">索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#构造百万级数据" class="sidebar-link">构造百万级数据</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#普通查询性能" class="sidebar-link">普通查询性能</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#创建索引" class="sidebar-link">创建索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#复合索引" class="sidebar-link">复合索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#hint方法指定索引查询" class="sidebar-link">hint方法指定索引查询</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#删除索引" class="sidebar-link">删除索引</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#全文索引" class="sidebar-link">全文索引</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#建立全文索引" class="sidebar-link">建立全文索引</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#全文索引查找" class="sidebar-link">全文索引查找</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#查找多个词" class="sidebar-link">查找多个词</a></li></ul></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#备份和还原" class="sidebar-link">备份和还原</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#数据备份" class="sidebar-link">数据备份</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#数据恢复" class="sidebar-link">数据恢复</a></li><li class="sidebar-sub-header"><a href="/jerry.github.io/backend/mongodb/02.MongoDB基本操作.html#参考文档" class="sidebar-link">参考文档</a></li></ul></li></ul></li><li><a href="/jerry.github.io/backend/mongodb/03.mongoose学习总结.html" class="sidebar-link">3. mongoose学习总结</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="mongo命令行"><a href="#mongo命令行" class="header-anchor">#</a> mongo命令行</h2> <blockquote><p>mongo Shell：每个数据库都有自己独特的命令，MSSQL和mySql用的都是Sql命令，MongoDB的操作命令就是前端最熟悉的JS命令。下面来看几个例子：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义一个变量</span>
<span class="token operator">&gt;</span> <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token string">'hello'</span>
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>需要注意：这里打印需要使用<code>print</code>，而不是<code>console</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义一个函数</span>
<span class="token operator">&gt;</span> <span class="token keyword">function</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">...</span> <span class="token keyword">return</span> <span class="token string">'123'</span><span class="token punctuation">;</span>
<span class="token operator">...</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token number">123</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="基本shell命令"><a href="#基本shell命令" class="header-anchor">#</a> 基本Shell命令</h3> <ul><li>show dbs：显示已有数据库，刚安装好的情况下，默认会有local、admin(config)，这是MongoDB的默认数据库，我们在新建库时是不允许起这些名称的，需要注意的是：该命令不显示数据为空的数据库；</li> <li>use admin：进入admin数据，也可以理解为使用数据库。成功会显示：switched to db admin；</li> <li>show collections：显示数据库中的集合；</li> <li>db：显示当前我们使用的数据库名称，这个命令最常用，因为我们在做任何操作之前都应该先查看一下当前所在的数据库，以免造成操作错误。</li></ul> <h3 id="mongodb存储结构"><a href="#mongodb存储结构" class="header-anchor">#</a> MongoDB存储结构</h3> <img src="/jerry.github.io/mongo/mongo.pn" alt=""> <p>由上图可以看出：关系型数据库的数据结构最顶层是数据库，数据库库下面是数据表，数据表下面是数据。但是MongoDB有所不同，数据库下面是集合，集合下面是文件。其实为了方便记忆，我们可以简单理解数据表就是集合，数据行就是文件。</p> <h2 id="数据基本操作"><a href="#数据基本操作" class="header-anchor">#</a> 数据基本操作</h2> <ul><li>use db：进入对应的数据库，需要注意：use不仅可以进入一个数据库，如果对应的数据库不存在，会自动创建响应的数据库，但是在没有集合前，该数据库默认为空；</li> <li>db.集合.insert()：新建集合和插入数据，当集合不存在时，会自动新建一个集合，并向里边插入对应数据；</li> <li>db.集合.find()：查询集合里的所有文件数据，这条命令会列出集合下的所有数据，可以看到MongoDB是自动给我们加入了索引值的；</li> <li>db.集合.findOne()：查询集合中的第一个文件数据，需要注意：MongoDB中的所有组合单词都使用首字母小写的驼峰式写法；</li> <li>db.集合.update({查询},{修改})：修改文件数据，第一个是查询条件，第二个是要修改成的值。需要注意的是：可以新增文件数据项的；</li> <li>db.集合.remove(条件)：删除文件数据，注意的是要跟一个条件；</li> <li>db.集合.drop()：删除整个集合，这个在实际工作中一定要谨慎使用，如果是程序，一定要二次确认；</li> <li>db.dropDatabase()：删除整个数据库，在删除库时，一定要先进入数据库，然后再删除。实际工作中这个基本不用，实际工作肯定需要保留数据和痕迹的。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 进入user数据库</span>
<span class="token operator">&gt;</span> use user
switched to db user

<span class="token comment">// 查看数据库中所有集合</span>
<span class="token operator">&gt;</span> show collections
books
people
users

<span class="token comment">// 向classRoom集合中插入两条数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nInserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nInserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 重新查看数据库中的所有集合</span>
<span class="token operator">&gt;</span> show collections
books
classRoom
people
users

<span class="token comment">// 查询所有数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a0b057780bbe7ea1514&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a13057780bbe7ea1515&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span> <span class="token punctuation">}</span>

<span class="token comment">// 查询第一个文件数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a0b057780bbe7ea1514&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span> <span class="token punctuation">}</span>

<span class="token comment">// 给name为lisi的数据项增加age</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 重新查询</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a0b057780bbe7ea1514&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a13057780bbe7ea1515&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span> <span class="token punctuation">}</span>

<span class="token comment">// 删除数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nRemoved&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 重新查询</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cba9a0b057780bbe7ea1514&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">18</span> <span class="token punctuation">}</span>

<span class="token comment">// 删除整个集合</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>classRoom<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token boolean">true</span>
<span class="token comment">// 重新查看数据库所有集合</span>
<span class="token operator">&gt;</span> show collections
books
people
users

<span class="token comment">// 新建user2数据库</span>
<span class="token operator">&gt;</span> use user2
switched to db user2
<span class="token comment">// 删除user2数据库</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">dropDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;dropped&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user2&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br></div></div><h3 id="插入数据"><a href="#插入数据" class="header-anchor">#</a> 插入数据</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 切换数据库(数据库不存在也没关系)</span>
<span class="token comment">// 如果test数据库不存在则创建，存在则切换到test数据库</span>
<span class="token operator">&gt;</span> use test
switched to db test
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 向test_collection集合中插入数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'鲁班七号'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nInserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="查询数据"><a href="#查询数据" class="header-anchor">#</a> 查询数据</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看存在的数据库</span>
<span class="token operator">&gt;</span> show dbs
admin    <span class="token number">0</span><span class="token punctuation">.</span>000GB
config   <span class="token number">0</span><span class="token punctuation">.</span>000GB
local    <span class="token number">0</span><span class="token punctuation">.</span>000GB
myDbs    <span class="token number">0</span><span class="token punctuation">.</span>000GB
myheros  <span class="token number">0</span><span class="token punctuation">.</span>000GB
test     <span class="token number">0</span><span class="token punctuation">.</span>000GB
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// find有6个参数</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>books<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>query<span class="token punctuation">,</span> fields<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> skip<span class="token punctuation">,</span> batchSize<span class="token punctuation">,</span> options<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看数据库版本</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span><span class="token function">version</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">3.6</span><span class="token number">.3</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用find查找数据</span>
<span class="token comment">// find方法参数为空则返回全部数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a56d52c0516ea271c4f82&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;鲁班七号&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a96fc2c0516ea271c4f83&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;后羿&quot;</span> <span class="token punctuation">}</span>
<span class="token comment">// 返回指定name的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'后羿'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a96fc2c0516ea271c4f83&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;后羿&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// for循环插入多条数据</span>
<span class="token operator">&gt;</span> <span class="token keyword">for</span><span class="token punctuation">(</span>i<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>i<span class="token operator">&lt;</span><span class="token number">100</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">)</span>db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span>i<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nInserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看集合中数据条数</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">100</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// skip(n) 跳过n条数据</span>
<span class="token comment">// limit(m) 限制返回m条数据</span>
<span class="token comment">// sort({x:1}) 根据x字段排序，1表示升序，-1表示降序</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a982c2c0516ea271c4f85&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a982c2c0516ea271c4f86&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">4</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a982c2c0516ea271c4f87&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a982c2c0516ea271c4f88&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">6</span> <span class="token punctuation">}</span>

<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaa480057780bbe7ea1577&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">97</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaa480057780bbe7ea1576&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">96</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaa480057780bbe7ea1575&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">95</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaa480057780bbe7ea1574&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">94</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaa480057780bbe7ea1573&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">93</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="更新数据"><a href="#更新数据" class="header-anchor">#</a> 更新数据</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询x:3数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a982c2c0516ea271c4f85&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">3</span> <span class="token punctuation">}</span>
<span class="token comment">// 更新x:3数据为x:333</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">333</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token literal-property property">z</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nInserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 部分数据更新采用$set</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">z</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">99</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 查询更新后的结果</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">z</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8a9be92c0516ea271c4fe6&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;x&quot;</span> <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;y&quot;</span> <span class="token operator">:</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;z&quot;</span> <span class="token operator">:</span> <span class="token number">100</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 第三个参数true，表示当y=100的数据不存在时，自动插入y=999的数据(即要更新的数据)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">100</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">999</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8b4e4cc06181d9a6bb896b&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">999</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5b8b4e4cc06181d9a6bb896b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;y&quot;</span> <span class="token operator">:</span> <span class="token number">999</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>collection<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>query<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token operator">&lt;</span>update<span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">upsert</span><span class="token operator">:</span> <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token literal-property property">multi</span><span class="token operator">:</span> <span class="token operator">&lt;</span>boolean<span class="token operator">&gt;</span><span class="token punctuation">,</span><span class="token literal-property property">writeConcern</span><span class="token operator">:</span> <span class="token operator">&lt;</span>document<span class="token operator">&gt;</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>参数说明：</p></blockquote> <ul><li>query：update的查询条件；</li> <li>update：update的对象和一些更新的操作符（如$,$inc...）等；</li> <li>upsert：可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false；</li> <li>multi：可选，mongodb 默认是false，只更新找到的第一条记录；</li> <li>writeConcern：可选，抛出异常的级别。</li></ul> <h2 id="删除数据"><a href="#删除数据" class="header-anchor">#</a> 删除数据</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 删除数据使用remove()方法，该方法必须传入参数，否则报错</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token number">2018</span><span class="token operator">-</span><span class="token number">09</span><span class="token operator">-</span>02T10<span class="token operator">:</span><span class="token number">51</span><span class="token operator">:</span><span class="token number">51.996</span><span class="token operator">+</span><span class="token number">0800</span> <span class="token constant">E</span> <span class="token constant">QUERY</span>    <span class="token punctuation">[</span>thread1<span class="token punctuation">]</span> Error<span class="token operator">:</span> remove needs a query <span class="token operator">:</span>
<span class="token class-name">DBCollection</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>_parseRemove@src<span class="token operator">/</span>mongo<span class="token operator">/</span>shell<span class="token operator">/</span>collection<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">357</span><span class="token operator">:</span><span class="token number">1</span>
<span class="token class-name">DBCollection</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>remove@src<span class="token operator">/</span>mongo<span class="token operator">/</span>shell<span class="token operator">/</span>collection<span class="token punctuation">.</span>js<span class="token operator">:</span><span class="token number">382</span><span class="token operator">:</span><span class="token number">18</span>
@<span class="token punctuation">(</span>shell<span class="token punctuation">)</span><span class="token operator">:</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">1</span>
<span class="token comment">// 删除y=999的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">y</span><span class="token operator">:</span><span class="token number">999</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nRemoved&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 删除数据表</span>
<span class="token comment">// 语法：db.表名.drop()</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>test_collection<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="使用js文件写mongo命令"><a href="#使用js文件写mongo命令" class="header-anchor">#</a> 使用js文件写mongo命令</h2> <p>在命令行中写mongo的命令很麻烦，我们可以是用js文件的形式来写shell命令和执行。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token string">'liujie'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> timeStamp <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 声明登录时的时间戳</span>
<span class="token keyword">const</span> jsonData <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;loginUser&quot;</span><span class="token operator">:</span> userName<span class="token punctuation">,</span> <span class="token string-property property">&quot;loginTime&quot;</span><span class="token operator">:</span> timeStamp<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 连接数据库</span>
db<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>jsonData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 插入数据</span>

<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'user print success'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 成功则打印信息</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>执行写好的js文件：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>➜  mongo demo1<span class="token punctuation">.</span>js
MongoDB shell version v3<span class="token punctuation">.</span><span class="token number">6.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span>
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
user print success
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>login<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaac8ff58ebe9136a70a0f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;loginUser&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;liujie&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;loginTime&quot;</span> <span class="token operator">:</span> <span class="token number">1555737743000</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="批量插入数据"><a href="#批量插入数据" class="header-anchor">#</a> 批量插入数据</h2> <p>批量数据插入是以数组的方式进行的。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在老版本MongoDB（3.2以前的版本基本都需要）是需要在Insert前加一个batch单词的，如下代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">batchInsert</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="循环插入"><a href="#循环插入" class="header-anchor">#</a> 循环插入</h3> <p>新建js文件<code>demo2.js</code>，具体内容如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 循环插入多条数据
 */</span>
<span class="token keyword">const</span> startTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取开始时间</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 连接数据库</span>
<span class="token comment">// 循环插入数据</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span> i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> runTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">;</span> <span class="token comment">// 计算时间差</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'demo run: '</span> <span class="token operator">+</span> runTime <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>➜  mongo demo2<span class="token punctuation">.</span>js
MongoDB shell version v3<span class="token punctuation">.</span><span class="token number">6.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span>
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
demo run<span class="token operator">:</span>288ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>循环插入需要200多毫秒。</p></blockquote> <h3 id="批量插入"><a href="#批量插入" class="header-anchor">#</a> 批量插入</h3> <p>新建js文件<code>demo3.js</code>，具体内容如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 批量插入数据
 */</span>
<span class="token keyword">const</span> startTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取开始时间</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 连接数据库</span>
<span class="token comment">// 批量插入数据</span>
<span class="token keyword">const</span> temArr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    temArr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">x</span><span class="token operator">:</span> i<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
db<span class="token punctuation">.</span>test<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>temArr<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 批量一次性插入</span>
<span class="token keyword">const</span> runTime <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">;</span> <span class="token comment">// 计算时间差</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'demo run: '</span> <span class="token operator">+</span> runTime <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>➜  mongo demo3<span class="token punctuation">.</span>js
MongoDB shell version v3<span class="token punctuation">.</span><span class="token number">6.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span>
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
demo run<span class="token operator">:</span> 12ms
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>批量插入仅仅需要十几毫秒。</p></blockquote> <p>需要注意：一次插入不要超过48M，像<code>.zip</code>和大图片等资源尽量采用静态存储，MongoDB存储静态路径就好。</p> <h2 id="update常见错误"><a href="#update常见错误" class="header-anchor">#</a> update常见错误</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 批量增加一些数据
 */</span>
<span class="token keyword">var</span> student1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'篮球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'足球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'羽毛球'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wangwu'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'游泳'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'健身'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'乒乓球'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaohong'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'瑜伽'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> studentArr <span class="token operator">=</span> <span class="token punctuation">[</span>student1<span class="token punctuation">,</span> student2<span class="token punctuation">,</span> student3<span class="token punctuation">]</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>studentArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'The data was inserted successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看插入后的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:24:36.707Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:24:36.707Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:24:36.707Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">// 修改小红的性别，这种写法是错误</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 修改后再次查看所有数据，发现并不符合预期</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:24:36.707Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6b&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:24:36.707Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabb24bfc8fb0139b04d6c&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>这样写的问题在于：我们的最后一条数据变成了只有<code>sex:0</code>，其它数据项全部丢失了。</p> <blockquote><p>正确写法：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 修改单条数据的正确写法
 */</span>

<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaohong'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'瑜伽'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> student3<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'The data was updated successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>这时候我们需要删除student集合中的数据，因为<code>xiaohong</code>这个用户已经不在数据库中了，然后重新使用load方法载入插入数据再进行修改。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//执行命令如下:</span>
db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo4.js'</span><span class="token punctuation">)</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo5.js'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>现在这种方法才是正确的，数据修改正常了，但是我们会发现写起来非常麻烦，而且特别容易写错。接下来我们学习一下<code>update</code>修改器，可以很好的解决这个问题。</p> <h2 id="update修改器"><a href="#update修改器" class="header-anchor">#</a> update修改器</h2> <h3 id="set修改器"><a href="#set修改器" class="header-anchor">#</a> $set修改器</h3> <p><code>$set</code>修改器用来修改一个指定的键值(key)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 修改</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;$set&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 查看修改后的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="修改嵌套内容"><a href="#修改嵌套内容" class="header-anchor">#</a> 修改嵌套内容</h3> <p>比如现在的<code>lisi</code>的爱好发生了变化，说她不会打篮球而是跳绳很好，需要进行修改。这时候我们会发现hobby数据是内嵌的，这时候我们可以属性的形式进行修改<code>hobby.hobbyOne</code>，代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 修改</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;$set&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;跳绳&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 查看</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳绳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="unset修改器"><a href="#unset修改器" class="header-anchor">#</a> $unset修改器</h3> <p><code>$unset</code>的作用是：删除一个key值和键。当我们删除后，想加回来可以直接用<code>$set</code>进行添加。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 删除hobby.hobbyOne</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$unset</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span><span class="token string">&quot;&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// 查询</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token comment">// 重新添加</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;lisi&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span><span class="token string">&quot;篮球&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="inc修改器"><a href="#inc修改器" class="header-anchor">#</a> $inc修改器</h3> <p><code>$inc</code>修改器用于对数字进行计算，可以对value值进行修改，但是修改的必须是数字，字符串是不起作用的。现在把<code>xiaohong</code>的年龄减去3岁，就可以直接用<code>$inc</code>来操作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span><span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$inc</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;age&quot;</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="multi选项"><a href="#multi选项" class="header-anchor">#</a> multi选项</h3> <blockquote><p>把每个学生的住址也加进来</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 这种写法只会改变第一条数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>

<span class="token comment">// 加上{multi:true}，则是改变所有的数据项</span>
<span class="token comment">// multi可取ture和false两个值，true代表全部修改，false代表只修改一个</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">address</span><span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">multi</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="upsert选项"><a href="#upsert选项" class="header-anchor">#</a> upsert选项</h3> <p>upsert选项作用是：在找不到的情况下，直接插入这条数据。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zhaoliu'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>

<span class="token comment">// upsert也有两个值：true代表没有就添加，false代表没有不添加(默认值)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zhaoliu'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">upsert</span><span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
	<span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="update数组修改器"><a href="#update数组修改器" class="header-anchor">#</a> update数组修改器</h2> <h3 id="push修改器"><a href="#push修改器" class="header-anchor">#</a> $push修改器</h3> <p><code>$push</code>的功能是追加数组中的值，但我们也经常用它操作内嵌稳文档，就是{}对象型的值。具体代码如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 给lisi增加爱好4，是数组形式的</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$push</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyFour&quot;</span><span class="token operator">:</span> <span class="token string">&quot;台球&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="ne修改器"><a href="#ne修改器" class="header-anchor">#</a> $ne修改器</h3> <p><code>$ne</code>修改器的主要作用是：检查一个值是否存在，如果不存在再执行操作，存在就不执行。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 如果lisi的skill中没有开车，则添加</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span> <span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$ne</span><span class="token operator">:</span> <span class="token string">'开车'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$push</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token string">'开车'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;开车&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>总结：没有则修改，有则不修改。</p></blockquote> <h3 id="addtoset修改器"><a href="#addtoset修改器" class="header-anchor">#</a> $addToSet修改器</h3> <p><code>$addToSet</code>是<code>$ne</code>的升级版本，查找是否存在，不存在就push进去，操作起来更直观和方便，所以在工作中用的更多。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看lisi有没有react技能，没有则添加</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$addToSet</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token string">'react'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;开车&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="each修改器"><a href="#each修改器" class="header-anchor">#</a> $each修改器</h3> <p><code>$each</code>用于：批量添加，可以传入一个数组，一次增加多个值进去，相当于批量操作，性能同样比循环操作要好很多，这个是需要我们注意的，工作中也要先组合成数组，然后用批量的形式进行操作。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> tempSkill <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span> <span class="token string">'vue'</span><span class="token punctuation">,</span> <span class="token string">'webpack'</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 同时给wangwu增加3个skill</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wangwu'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">$addToSet</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$each</span><span class="token operator">:</span>tempSkill<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;开车&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;webpack&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="pop修改器"><a href="#pop修改器" class="header-anchor">#</a> $pop修改器</h3> <p><code>$pop</code>只删除一次，并不是删除所有数组中的值。而且它有两个选项，一个是1和-1。</p> <ul><li>1：从数组末端进行删除</li> <li>-1：从数组开端进行删除</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 删除wangwu的最后一项skill</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wangwu'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$pop</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;开车&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="数组定位修改"><a href="#数组定位修改" class="header-anchor">#</a> 数组定位修改</h3> <p>有时候只知道修改数组的第几位，但并不知道是什么，这时候我们可以使用<code>数据项.int</code>的形式。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 修改wangwu的第2个skill为san，需要注意这里的计数是从0开始的</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wangwu'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token string-property property">'skill.1'</span><span class="token operator">:</span><span class="token string">'san'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">WriteResult</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string-property property">&quot;nMatched&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nUpserted&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;nModified&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;台球&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;开车&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;san&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6f&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:46.360Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbac8243ba35f60e25bffff&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;score&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token number">89</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="修改状态返回与安全"><a href="#修改状态返回与安全" class="header-anchor">#</a> 修改状态返回与安全</h2> <h3 id="应答式写入"><a href="#应答式写入" class="header-anchor">#</a> 应答式写入</h3> <p>我们之前的操作都是非应答式写入，就是在操作完数据库后，数据库并没有给我们任何的回应和返回值，而是我们自己写了一句话<code>print('The data was updated successfully');</code>。这在工作中是不允许的，因为根本不能体现我们修改的结果。</p> <p>应答式写入就会给我们直接返回结果，结果里边的包含项会很多，这样我们就可以很好的进行程序的控制和安全机制的处理。</p> <h3 id="db-runcommand"><a href="#db-runcommand" class="header-anchor">#</a> db.runCommand()</h3> <p><code>db.runCommand()</code>是数据库运行命令的执行器，执行命令首选就要使用它，因为它在Shell和驱动程序间提供了一致的接口。几乎所有的数据库操作，都可以使用runCommand命令来执行。现在我们试着用runCommand来修改数据库，看看结果和直接用<code>db.collections.update</code>有什么不同。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">sex</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token keyword">class</span><span class="token operator">:</span><span class="token string">'三年级2班'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> resMsg <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">getLastError</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printjson</span><span class="token punctuation">(</span>resMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo6.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;connectionId&quot;</span> <span class="token operator">:</span> <span class="token number">48</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;updatedExisting&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">//该字段为true，说明操作成功了</span>
        <span class="token string-property property">&quot;n&quot;</span> <span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;syncMillis&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;writtenTo&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;err&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>false：第一句末尾的false是upsert的简写，代表没有此条数据时不增加</li> <li>true：true是multi的简写，代表修改所有，这两个我们在前边课程已经学过</li> <li><code>getLastError:1</code>：表示返回功能错误</li> <li>printjson：表示以json对象的格式输出到控制台</li></ul> <blockquote><p>db.listCommands()：查看所有的Commad命令。</p></blockquote> <p>比如我们要查看是否和数据库链接成功了，就可以使用Command命令。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">ping</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>返回<code>ok：1</code>就代表链接正常。</p> <h3 id="findandmodify"><a href="#findandmodify" class="header-anchor">#</a> findAndModify</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// demo7.js</span>
<span class="token keyword">const</span> customModify <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">findAndModify</span><span class="token operator">:</span> <span class="token string">'student'</span><span class="token punctuation">,</span> <span class="token comment">// 指定要查找的集合</span>
    <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">update</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$set</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token keyword">new</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 更新完成，需要查看结果，如果为false不进行查看结果</span>
    <span class="token comment">// fields: {name: true, age: true, _id: false} // 只显示name和age</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> resMsg <span class="token operator">=</span> db<span class="token punctuation">.</span><span class="token function">runCommand</span><span class="token punctuation">(</span>customModify<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">printjson</span><span class="token punctuation">(</span>resMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo7.js'</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;lastErrorObject&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;n&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;updatedExisting&quot;</span> <span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;value&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbabd2b0712a21a9fdb3b6d&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                        <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span>
                        <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span><span class="token punctuation">,</span>
                        <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span>
                        <span class="token string-property property">&quot;hobbyFour&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
                                <span class="token string">&quot;台球&quot;</span>
                        <span class="token punctuation">]</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T06:33:15.407Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;address&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
                        <span class="token string">&quot;开车&quot;</span><span class="token punctuation">,</span>
                        <span class="token string">&quot;react&quot;</span>
                <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><blockquote><p>findAndModify属性值：</p></blockquote> <ul><li>query：需要查询的条件/文档</li> <li>sort：进行排序</li> <li>update：查找到后进行相应的更新</li> <li>remove：[boolean]是否删除查找到的文档，值为true，可以删除</li> <li>new：[boolean]返回更新前的文档还是更新后的文档</li> <li>fields：需要返回的字段</li> <li>upsert：没有这个值是否增加</li></ul> <blockquote><p>需要注意：update和remove只能同时存在一个。</p></blockquote> <h2 id="查询find的不等修饰符"><a href="#查询find的不等修饰符" class="header-anchor">#</a> 查询find的不等修饰符</h2> <blockquote><p>构造一些数据：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 批量增加一些数据
 */</span>
<span class="token keyword">var</span> student1 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'篮球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'足球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'羽毛球'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student2 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'wangwu'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'游泳'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'健身'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'乒乓球'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student3 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaohong'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'瑜伽'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student4 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaohua'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'体操'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student5 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zhaoliu'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'音乐'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'美术'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student6 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaoli'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'体操'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student7 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaoliu'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'钓鱼'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student8 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'zhangsan'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'足球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student9 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'lihua'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'篮球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> student10 <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'xiaozhang'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span>
    <span class="token literal-property property">sex</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">hobbyOne</span><span class="token operator">:</span> <span class="token string">'乒乓球'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyTwo</span><span class="token operator">:</span> <span class="token string">'跳舞'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">hobbyThree</span><span class="token operator">:</span> <span class="token string">'书法'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">skill</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> studentArr <span class="token operator">=</span> <span class="token punctuation">[</span>student1<span class="token punctuation">,</span> student2<span class="token punctuation">,</span> student3<span class="token punctuation">,</span> student4<span class="token punctuation">,</span> student5<span class="token punctuation">,</span> student6<span class="token punctuation">,</span> student7<span class="token punctuation">,</span> student8<span class="token punctuation">,</span> student9<span class="token punctuation">,</span> student10<span class="token punctuation">]</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>studentArr<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'The data was inserted successfully'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo8.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
The data was inserted successfully
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="简单查找"><a href="#简单查找" class="header-anchor">#</a> 简单查找</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查找hobbyOne是篮球的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaeef75328a836aca6e026&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbaeef75328a836aca6e02e&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="筛选字段"><a href="#筛选字段" class="header-anchor">#</a> 筛选字段</h3> <blockquote><p>find的第二个参数可以用来指定返回的字段。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 只显示name和hobby</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">hobby</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="不等修饰符"><a href="#不等修饰符" class="header-anchor">#</a> 不等修饰符</h3> <ul><li>小于($lt)：英文全称less-than</li> <li>小于等于($lte)：英文全称less-than-equal</li> <li>大于($gt)：英文全称greater-than</li> <li>大于等于($gte)：英文全称greater-than-equal</li> <li>不等于($ne)：英文全称not-equal</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查年龄大于等于12，且小于等于14的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
<span class="token parameter"><span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$lte</span><span class="token operator">:</span><span class="token number">14</span><span class="token punctuation">,</span> <span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
<span class="token operator">...</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="日期筛选"><a href="#日期筛选" class="header-anchor">#</a> 日期筛选</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token keyword">var</span> startTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'01/01/2019'</span><span class="token punctuation">)</span>
<span class="token comment">// 筛选创建日期大于2019年1月1日的数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">createTime</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$gt</span><span class="token operator">:</span>startTime<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">createTime</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">_id</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T10:05:43.190Z&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="find的多条件查询"><a href="#find的多条件查询" class="header-anchor">#</a> find的多条件查询</h2> <h3 id="in修饰符"><a href="#in修饰符" class="header-anchor">#</a> $in修饰符</h3> <p><code>$in</code>修饰符可以轻松解决一键多值的查询情况。和<code>$in</code>相对的修饰符是<code>$nin</code>，即查询除了<code>$in</code>条件以外的值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询年龄是10或者13的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span>$<span class="token keyword">in</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span></span>
<span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p><code>$nin</code>：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$nin</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="or修饰符"><a href="#or修饰符" class="header-anchor">#</a> $or修饰符</h3> <p><code>$or</code>修饰符用来查询多个键值的情况，就比如查询学生中大于等于13岁或者hobbyOne是篮球，而<code>$in</code>修饰符是用于一个Key值的情况，相对应的还有<code>$nor</code>修饰符。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">$or</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">hobby</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p><code>$nor</code>：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 筛选年龄小于13且hobbyOne不是篮球的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">$nor</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">hobby</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;游泳&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;健身&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;体操&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;音乐&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;美术&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;体操&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;钓鱼&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;乒乓球&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="and修饰符"><a href="#and修饰符" class="header-anchor">#</a> $and修饰符</h3> <p><code>$and</code>用来查找几个key值都满足的情况。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 筛选年龄大于等于13且hobbyOne是篮球的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">$and</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span><span class="token literal-property property">age</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">$gte</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string-property property">&quot;hobby.hobbyOne&quot;</span><span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">}</span> <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">hobby</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;瑜伽&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;跳舞&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;书法&quot;</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="not修饰符"><a href="#not修饰符" class="header-anchor">#</a> $not修饰符</h3> <p><code>$not</code>修饰符用来查询除条件之外的值。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询除了大于等于11，小于等于12的学生，即查询小于11或者大于12的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
<span class="token operator">...</span> age<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token operator">...</span> $not<span class="token operator">:</span><span class="token punctuation">{</span>
<span class="token operator">...</span> $lte<span class="token operator">:</span><span class="token number">12</span><span class="token punctuation">,</span>
<span class="token operator">...</span> $gte<span class="token operator">:</span><span class="token number">11</span>
<span class="token operator">...</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="find的数组查询"><a href="#find的数组查询" class="header-anchor">#</a> find的数组查询</h2> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 重新加载一遍数据</span>
<span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./demo8.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
The data was inserted successfully
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="基本数据查询"><a href="#基本数据查询" class="header-anchor">#</a> 基本数据查询</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询skill是['react','vue','css3']数据</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span><span class="token string">'vue'</span><span class="token punctuation">,</span><span class="token string">'css3'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token operator">...</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><blockquote><p>下面我们想查找skill中有react的学生。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>运行后，并没有得到相应的学生数据。那问题出现在哪里呢？问题就在于：我们写了一个中括号([])，加上中括号就相当于完全匹配了，所以没有得到一条符合查询条件的数据，我们去掉中括号再看看结果。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token string">'react'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>以上就是我们在数组中查询一项的方法。</p> <h3 id="all修饰符"><a href="#all修饰符" class="header-anchor">#</a> $all修饰符</h3> <p><code>$all</code>修饰符用于数据多项查询。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询skill中既有react和vue的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$all</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span><span class="token string">'vue'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="in修饰符-2"><a href="#in修饰符-2" class="header-anchor">#</a> $in修饰符</h3> <p>用<code>$all</code>修饰符，是需要满足所有条件才可以，<code>$in</code>修饰符是只要满足数组中的一项就可以被查出来(有时候会跟<code>$or</code>弄混)。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询skill中有react或者vue的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span>$<span class="token keyword">in</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">'react'</span><span class="token punctuation">,</span><span class="token string">'vue'</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="size修饰符"><a href="#size修饰符" class="header-anchor">#</a> $size修饰符</h3> <p><code>$size</code>修饰符可以根据数组长度来检索。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询skill有5项的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$size</span><span class="token operator">:</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;san&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;jquery&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="slice修饰符"><a href="#slice修饰符" class="header-anchor">#</a> $slice修饰符</h3> <blockquote><p>只显示每个学生的skill的前两项。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
<span class="token parameter"><span class="token operator">...</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$slice</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token operator">...</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;san&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;vue&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;webpack&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;node&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;js&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;http&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;npm&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;ES6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ES7&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;vue&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;san&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;echarts&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;ES6&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><blockquote><p>只显示每个学生的skill的最后一项。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token parameter"><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">skill</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$slice</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span></span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;webpack&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoli&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html5&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;ES8&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhangsan&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;css3&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lihua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html5&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaozhang&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;html5&quot;</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="find的参数使用方法"><a href="#find的参数使用方法" class="header-anchor">#</a> find的参数使用方法</h2> <blockquote><p>find参数：</p></blockquote> <ul><li>query：这个是查询条件，MongoDB默认的第一个参数；</li> <li>fields：需要返回的字段，可以用true和false控制是否显示；</li> <li>limit：返回的数量，后边跟数字，控制每次查询返回的结果数量；</li> <li>skip：跳过多少个显示，和limit结合可以实现分页；</li> <li>sort：排序方式，1代表升序，-1代表降序；</li></ul> <h3 id="模拟分页"><a href="#模拟分页" class="header-anchor">#</a> 模拟分页</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string-property property">'age'</span><span class="token operator">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;wangwu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohua&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;zhaoliu&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>需要注意：skip()，limit()，sort()三个方法放在一起执行的时候，执行顺序是先sort()，然后是skip()，最后是limit()。</p></blockquote> <h3 id="where修饰符"><a href="#where修饰符" class="header-anchor">#</a> $where修饰符</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查询年龄大于12的学生</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">$where</span><span class="token operator">:</span><span class="token string">&quot;this.age&gt;12&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token operator">...</span> <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">age</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token literal-property property">_id</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">}</span>
<span class="token operator">...</span> <span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;xiaohong&quot;</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">13</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>这里的this指向的是<code>student</code>集合本身。这样我们就可以在程序中随意调用。虽然强大和灵活，但是这种查询对于数据库的压力和安全性都会变重，所以在工作中尽量减少<code>$where</code>修饰符的使用。</p> <h2 id="find如何在js文本中使用"><a href="#find如何在js文本中使用" class="header-anchor">#</a> find如何在js文本中使用</h2> <h3 id="hasnext循环结果"><a href="#hasnext循环结果" class="header-anchor">#</a> hasNext循环结果</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 链接数据库</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 声明变量result，并把查询结果赋值给result</span>
<span class="token comment">// 利用游标的hasNext()进行循环输出结果</span>
<span class="token keyword">while</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">printjson</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 用json格式打印结果</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./hasNext.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb06aa5328a836aca6e03a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;lisi&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;age&quot;</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;sex&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;hobby&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
                <span class="token string-property property">&quot;hobbyOne&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;篮球&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;hobbyTwo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;足球&quot;</span><span class="token punctuation">,</span>
                <span class="token string-property property">&quot;hobbyThree&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;羽毛球&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;skill&quot;</span> <span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token string">&quot;js&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;css&quot;</span><span class="token punctuation">,</span>
                <span class="token string">&quot;html&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;createTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T11:46:50.291Z&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token operator">...</span>
<span class="token operator">...</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="foreach循环结果"><a href="#foreach循环结果" class="header-anchor">#</a> forEach循环结果</h3> <blockquote><p><code>forEach.js</code>：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 链接数据库</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> db<span class="token punctuation">.</span>student<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 声明变量result，并把查询结果赋值给result</span>
result<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">result</span> <span class="token operator">=&gt;</span> <span class="token function">printjson</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 执行即可看到结果</span>
<span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./forEach.js'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="索引"><a href="#索引" class="header-anchor">#</a> 索引</h2> <h3 id="构造百万级数据"><a href="#构造百万级数据" class="header-anchor">#</a> 构造百万级数据</h3> <p>索引的性能体现必须要有大量数据才能看出来，如果说只有有10条20条数据，是根本看不出来效果的，我们首先通过随机数的方法，构造出一个百万级数据的数据库出来。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//生成随机数</span>
<span class="token keyword">function</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> range <span class="token operator">=</span> max<span class="token operator">-</span>min<span class="token punctuation">;</span>   <span class="token comment">// 得到随机数区间</span>
    <span class="token keyword">let</span> rand <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 得到随机值</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>min <span class="token operator">+</span> Math<span class="token punctuation">.</span><span class="token function">round</span><span class="token punctuation">(</span>rand <span class="token operator">*</span>range<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 最小值+随机数取整</span>
<span class="token punctuation">}</span>

<span class="token comment">// console.log(createRandomNum(10000, 99999));</span>

<span class="token comment">// 生成随机用户名</span>
<span class="token keyword">function</span> <span class="token function">createRandomUserName</span><span class="token punctuation">(</span><span class="token parameter">min<span class="token punctuation">,</span> max</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> tempStringArray<span class="token operator">=</span> <span class="token string">&quot;123456789qwertyuiopasdfghjklzxcvbnm&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//构造生成时的字母库数组</span>
    <span class="token keyword">let</span> outPutText <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">//最后输出的变量</span>
    <span class="token comment">//进行循环，随机生产用户名的长度，这里需要生成随机数方法的配合</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span>min<span class="token punctuation">,</span> max<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//随机抽取字母，拼装成需要的用户名</span>
        outPutText <span class="token operator">=</span> outPutText <span class="token operator">+</span> tempStringArray<span class="token punctuation">[</span><span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>tempStringArray<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> outPutText<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// console.log(createRandomUserName(7, 16));</span>
<span class="token comment">// var startTime=(new Date()).getTime();</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> tempInfo <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">2000000</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    tempInfo<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token function">createRandomUserName</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">regeditTime</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum0</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum1</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum2</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum3</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum4</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum5</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum6</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum7</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum8</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token literal-property property">randNum9</span><span class="token operator">:</span> <span class="token function">createRandomNum</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span><span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>tempInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./createRandomUser.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看数据量</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">stats</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>count
<span class="token number">2000000</span>
<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="普通查询性能"><a href="#普通查询性能" class="header-anchor">#</a> 普通查询性能</h3> <blockquote><p>200万数据普通检索：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> startTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 得到程序开始运行的时间</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 链接数据库</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'5pnyce'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 根据用户名查找用户</span>
res<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token function">printjson</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 循环输出</span>
<span class="token keyword">var</span> runTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">;</span> <span class="token comment">// 得到程序运行时间</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'This run time is: '</span> <span class="token operator">+</span> runTime <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//打印出运行时间</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./customSearch.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb16755328a836aca866f9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;username&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5pnyce&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;regeditTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T12:54:01.742Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum0&quot;</span> <span class="token operator">:</span> <span class="token number">725085</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum1&quot;</span> <span class="token operator">:</span> <span class="token number">401201</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum2&quot;</span> <span class="token operator">:</span> <span class="token number">600271</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum3&quot;</span> <span class="token operator">:</span> <span class="token number">145201</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum4&quot;</span> <span class="token operator">:</span> <span class="token number">292000</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum5&quot;</span> <span class="token operator">:</span> <span class="token number">511782</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum6&quot;</span> <span class="token operator">:</span> <span class="token number">915503</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum7&quot;</span> <span class="token operator">:</span> <span class="token number">427219</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum8&quot;</span> <span class="token operator">:</span> <span class="token number">513973</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum9&quot;</span> <span class="token operator">:</span> <span class="token number">246754</span>
<span class="token punctuation">}</span>
This run time is<span class="token operator">:</span> 3779ms
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>从上面运行结果来看，大概需要3.7秒，这个时间是没办法满足我们的日常查询的。</p></blockquote> <h3 id="创建索引"><a href="#创建索引" class="header-anchor">#</a> 创建索引</h3> <blockquote><p>数据量少的时候，不使用索引查询速度还是很快的；但是当数据量较大时，不使用索引的话查询速度将会变的很慢。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 查看当前集合的索引，目前只有一个_id_索引</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><blockquote><p><code>MongoDB</code>使用<code>ensureIndex({key: 1})</code>方法来创建索引：</p></blockquote> <p>key为我们要创建的索引字段，1为按升序创建索引，-1为按降序创建索引。
也可以设置使用多个字段创建索引（关系型数据库中称作复合索引）
<code>db.col_name.ensureIndex({key:1})</code>。需要注意的是：3.0版本后推荐使用<code>createIndex()</code>来创建索引。</p> <blockquote><p>为用户名<code>username</code>建立索引：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">ensureIndex</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string-property property">&quot;createdCollectionAutomatically&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;numIndexesBefore&quot;</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;numIndexesAfter&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token comment">// 说明创建索引成功了</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 再次查看索引</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;username&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;username_1&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>重新查询：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./customSearch.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb16755328a836aca866f9&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;username&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;5pnyce&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;regeditTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T12:54:01.742Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum0&quot;</span> <span class="token operator">:</span> <span class="token number">725085</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum1&quot;</span> <span class="token operator">:</span> <span class="token number">401201</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum2&quot;</span> <span class="token operator">:</span> <span class="token number">600271</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum3&quot;</span> <span class="token operator">:</span> <span class="token number">145201</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum4&quot;</span> <span class="token operator">:</span> <span class="token number">292000</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum5&quot;</span> <span class="token operator">:</span> <span class="token number">511782</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum6&quot;</span> <span class="token operator">:</span> <span class="token number">915503</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum7&quot;</span> <span class="token operator">:</span> <span class="token number">427219</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum8&quot;</span> <span class="token operator">:</span> <span class="token number">513973</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum9&quot;</span> <span class="token operator">:</span> <span class="token number">246754</span>
<span class="token punctuation">}</span>
This run time is<span class="token operator">:</span> 25ms
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><blockquote><p>只需要25ms，查询性能大大提升。</p></blockquote> <blockquote><p>总结：无论是在关系型数据库还是非关系型数据库，建立索引都是非常重要的。但是，需要注意的是：索引是要消耗硬盘和内存资源的，所以还是要根据程序需要进行建立了。MongoDB也给我们进行了限制，只允许我们建立64个索引值。</p></blockquote> <h2 id="复合索引"><a href="#复合索引" class="header-anchor">#</a> 复合索引</h2> <p>复合索引简单理解就是：两条以上的索引。</p> <blockquote><p>不用索引的情况：</p></blockquote> <ul><li>数据不超万条时，不需要使用索引。性能的提升并不明显，而且大大增加了内存和硬盘的消耗；</li> <li>查询数据超过表数据量30%时，不要使用索引字段查询。实际证明会比不使用索引更慢，因为它大量检索了索引表和我们原表；</li> <li>数字索引，要比字符串索引快的多，在百万级甚至千万级数据量面前，使用数字索引是个明确的选择；</li> <li>把我们经常查询的数据做成一个内嵌数据(对象型的数据)，然后集体进行索引</li></ul> <blockquote><p>现在把<code>randNum0</code>这个字段也设置成索引。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">ensureIndex</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span><span class="token literal-property property">randNum0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
	<span class="token string-property property">&quot;createdCollectionAutomatically&quot;</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;numIndexesBefore&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;numIndexesAfter&quot;</span> <span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
	<span class="token string-property property">&quot;ok&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><blockquote><p>一共有三个索引，两个自建索引<code>username和randNum0</code>。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">getIndexes</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;_id_&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;username&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;username_1&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
	<span class="token punctuation">{</span>
		<span class="token string-property property">&quot;v&quot;</span> <span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;key&quot;</span> <span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token string-property property">&quot;randNum0&quot;</span> <span class="token operator">:</span> <span class="token number">1</span>
		<span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;randNum0_1&quot;</span><span class="token punctuation">,</span>
		<span class="token string-property property">&quot;ns&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;user.randomInfo&quot;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/**
 * 200万数据复合索引检索
 */</span>
<span class="token keyword">var</span> startTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 得到程序开始运行的时间</span>
<span class="token keyword">var</span> db <span class="token operator">=</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token string">'user'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 链接数据库</span>
<span class="token keyword">var</span> res <span class="token operator">=</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'n7wl5kq'</span><span class="token punctuation">,</span> <span class="token literal-property property">randNum0</span><span class="token operator">:</span> <span class="token number">754417</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 根据用户名和randNum0查找用户</span>
res<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">item</span> <span class="token operator">=&gt;</span> <span class="token function">printjson</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 循环输出</span>
<span class="token keyword">var</span> runTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> startTime<span class="token punctuation">;</span> <span class="token comment">// 得到程序运行时间</span>
<span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'This run time is: '</span> <span class="token operator">+</span> runTime <span class="token operator">+</span> <span class="token string">'ms'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//打印出运行时间</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token string">'./customSearch.js'</span><span class="token punctuation">)</span>
connecting to<span class="token operator">:</span> mongodb<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">27017</span><span class="token operator">/</span>user
MongoDB server version<span class="token operator">:</span> <span class="token number">3.6</span><span class="token number">.3</span>
<span class="token punctuation">{</span>
        <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb16755328a836aca866fb&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;username&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;n7wl5kq&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;regeditTime&quot;</span> <span class="token operator">:</span> <span class="token function">ISODate</span><span class="token punctuation">(</span><span class="token string">&quot;2019-04-20T12:54:01.742Z&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum0&quot;</span> <span class="token operator">:</span> <span class="token number">754417</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum1&quot;</span> <span class="token operator">:</span> <span class="token number">405438</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum2&quot;</span> <span class="token operator">:</span> <span class="token number">513075</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum3&quot;</span> <span class="token operator">:</span> <span class="token number">888891</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum4&quot;</span> <span class="token operator">:</span> <span class="token number">586031</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum5&quot;</span> <span class="token operator">:</span> <span class="token number">704484</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum6&quot;</span> <span class="token operator">:</span> <span class="token number">906708</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum7&quot;</span> <span class="token operator">:</span> <span class="token number">303593</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum8&quot;</span> <span class="token operator">:</span> <span class="token number">164085</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;randNum9&quot;</span> <span class="token operator">:</span> <span class="token number">589671</span>
<span class="token punctuation">}</span>
This run time is<span class="token operator">:</span> 20ms
<span class="token boolean">true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>查询时间还是在20ms左右。MongoDB的复合查询是按照我们的索引顺序进行查询的。就是我们用<code>db.randomInfo.getIndexes()</code>查询出的数组。</p> <h3 id="hint方法指定索引查询"><a href="#hint方法指定索引查询" class="header-anchor">#</a> hint方法指定索引查询</h3> <p>我们都知道数字索引要比字符串索引快，这就需要一个方法来打破索引表的查询顺序，优先使用我们自己指定的索引查询，这个方法就是<code>hint()</code>.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> res <span class="token operator">=</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">'n7wl5kq'</span><span class="token punctuation">,</span> <span class="token literal-property property">randNum0</span><span class="token operator">:</span> <span class="token number">754417</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hint</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">randNum0</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于数据量和复杂程度还是不大，所以我们看不出来明显的性能提升，但是，当我们在工作中遇到大数据时，一定会得到很好的效果。</p> <h3 id="删除索引"><a href="#删除索引" class="header-anchor">#</a> 删除索引</h3> <p>当索引性能不佳或起不到作用时，我们需要删除索引，删除索引的命令是<code>dropIndex()</code>。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">dropIndex</span><span class="token punctuation">(</span><span class="token string">'randNum0_1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//索引的唯一ID</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>需要注意的是：删除索引时填写的值，并不是我们的字段名称(key，即randNum0)，而是我们索引查询表中的name值。</p> <h2 id="全文索引"><a href="#全文索引" class="header-anchor">#</a> 全文索引</h2> <blockquote><p>准备数据：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">contextInfo</span><span class="token operator">:</span><span class="token string">&quot;I am a student. I love learning. I am good at playing basketball and football. I love my family, I love my parents.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">contextInfo</span><span class="token operator">:</span><span class="token string">&quot;I am a research and development engineer. I love working and studying. I love my family, I love my parents.&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="建立全文索引"><a href="#建立全文索引" class="header-anchor">#</a> 建立全文索引</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">ensureIndex</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">contextInfo</span><span class="token operator">:</span><span class="token string">'text'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>需要注意的是：这里使用<code>text</code>关键词来代表全文索引，就不建立数据模型了。</p> <h3 id="全文索引查找"><a href="#全文索引查找" class="header-anchor">#</a> 全文索引查找</h3> <p>建立好了全文索引，就可以查找了，查找时需要两个关键修饰符:</p> <ul><li>$text：表示要在全文索引中查东西</li> <li>$search：后边跟查找的内容</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">$text</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$search</span><span class="token operator">:</span><span class="token string">&quot;student&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb3105466a2bd461ae0f42&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;contextInfo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;I am a student. I love learning. I am good at playing basketball and football. I love my family, I love my parents.&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="查找多个词"><a href="#查找多个词" class="header-anchor">#</a> 查找多个词</h3> <p>全文索引支持多个词语查找，比如我们希望查找数据中有<code>student engineer learning</code>的数据(这是或的关系)，所以两条数据都会出现。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">$text</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$search</span><span class="token operator">:</span><span class="token string">&quot;student engineer learning&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb3107466a2bd461ae0f43&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;contextInfo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;I am a research and development engineer. I love working and studying. I love my family, I love my parents.&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb3105466a2bd461ae0f42&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;contextInfo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;I am a student. I love learning. I am good at playing basketball and football. I love my family, I love my parents.&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果我们这时候希望不查找出来有<code>learning</code>这个单词的记录，我们可以使用<code>-</code>减号来取消。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">$text</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$search</span><span class="token operator">:</span><span class="token string">&quot;student engineer -learning&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>转义符：全文索引中是支持转义符的，比如我们想搜索的是两个词(love learning和development)，这时候需要使用<code>\</code>斜杠来转义。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token operator">&gt;</span> db<span class="token punctuation">.</span>info<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">$text</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">$search</span><span class="token operator">:</span><span class="token string">&quot;\'love learning\' development&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb3107466a2bd461ae0f43&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;contextInfo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;I am a research and development engineer. I love working and studying. I love my family, I love my parents.&quot;</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token string-property property">&quot;_id&quot;</span> <span class="token operator">:</span> <span class="token function">ObjectId</span><span class="token punctuation">(</span><span class="token string">&quot;5cbb3105466a2bd461ae0f42&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-property property">&quot;contextInfo&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;I am a student. I love learning. I am good at playing basketball and football. I love my family, I love my parents.&quot;</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>总结：全文索引在工作还是经常使用的，比如博客文章的搜索，长文件的关键词搜索，这些都需要使用全文索引来进行。</p> <h2 id="备份和还原"><a href="#备份和还原" class="header-anchor">#</a> 备份和还原</h2> <p>MongoDB数据库的备份和还原依赖<code>mongodump和mongorestore</code>两个命令，这两个命令直接在命令行执行就可以了，不需要在mongo命令行中。</p> <h3 id="数据备份"><a href="#数据备份" class="header-anchor">#</a> 数据备份</h3> <p><code>mongodump</code>备份的基本格式如下所示，其实就是一条在终端中执行的命令。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mongodump
    <span class="token operator">--</span>host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
    <span class="token operator">--</span>port <span class="token number">27017</span>
    <span class="token operator">--</span>out <span class="token operator">/</span>Users<span class="token operator">/</span>liujie26<span class="token operator">/</span>backup  <span class="token comment">// 备份数据的目录</span>
    <span class="token operator">--</span>collection student <span class="token comment">// 要备份的集合</span>
    <span class="token operator">--</span>db user <span class="token comment">// 要备份的数据库</span>
    <span class="token operator">--</span>username username <span class="token comment">// 当前操作的用户</span>
    <span class="token operator">--</span>password password
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>比如现在我们备份所有MongoDB里的数据库到<code>/Users/liujie26/backup</code>文件夹下，命令如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mongodump <span class="token operator">--</span>host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">--</span>port <span class="token number">27017</span> <span class="token operator">--</span>out <span class="token operator">/</span>Users<span class="token operator">/</span>liujie26<span class="token operator">/</span>backup
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="数据恢复"><a href="#数据恢复" class="header-anchor">#</a> 数据恢复</h3> <p>备份好后，如果数据库有意外或者遭受到了攻击，我们要进行恢复数据库，这时候就可以使用<code>mongorestore</code>命令。具体格式如下：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>mongorestore
    <span class="token operator">--</span>host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span>
    <span class="token operator">--</span>port <span class="token number">27017</span>
    <span class="token operator">--</span>username username
    <span class="token operator">--</span>password password
    <span class="token operator">&lt;</span>path to the backup<span class="token operator">&gt;</span> <span class="token comment">// 备份数据所在目录</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>比如我们现在不小心删除了一个collections的数据，要进行恢复。现在删除<code>randomInfo</code>集合。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 先删除指定集合</span>
<span class="token operator">&gt;</span> db<span class="token punctuation">.</span>randomInfo<span class="token punctuation">.</span><span class="token function">drop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token boolean">true</span>
<span class="token comment">// 删除后查询集合确实被删除</span>
<span class="token operator">&gt;</span> show collections
books
info
login
people
student
test
users

<span class="token comment">// 恢复被删除集合数据</span>
mongorestore <span class="token operator">--</span>host <span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span> <span class="token operator">--</span>port <span class="token number">27017</span> <span class="token operator">/</span>Users<span class="token operator">/</span>liujie26<span class="token operator">/</span>backup

<span class="token comment">// 恢复后查询集合数据确实被恢复</span>
<span class="token operator">&gt;</span> show collections
books
info
login
people
randomInfo
student
test
users
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>总结：两个命令很简单，甚至我们可以写成脚本和定时任务，让它每天自己执行。但是如果我们真的使用了MongoDB数据库，这是一个最基本的操作，还是要会使用的。</p> <h3 id="参考文档"><a href="#参考文档" class="header-anchor">#</a> 参考文档</h3> <ol><li><a href="https://blog.csdn.net/kk185800961/article/details/45619863" target="_blank" rel="noopener noreferrer">MongoDB 基础（六）安全性（权限操作）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2022-02-28 16:06:13</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/jerry.github.io/backend/mongodb/01.Mac安装MongoDB.html" class="prev">
        1. Mac安装MongoDB
      </a></span> <span class="next"><a href="/jerry.github.io/backend/mongodb/03.mongoose学习总结.html">
        3. mongoose学习总结
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/jerry.github.io/assets/js/app.8cb867ca.js" defer></script><script src="/jerry.github.io/assets/js/2.7d547363.js" defer></script><script src="/jerry.github.io/assets/js/46.f81f1bfa.js" defer></script><script src="/jerry.github.io/assets/js/20.cf42ebc2.js" defer></script>
  </body>
</html>
